import{ApprovalCtrl}from"./ApprovalController";import{idNumberFormat}from"../../common/tools";import{RightsWindow}from"./RightsWindow";const PartyGrid={id:"apv:partgrid_cnt",height:180,borderless:!0,cols:[{width:280,rows:[{id:"ipg:su_details",view:"property",editable:!1,nameWidth:120,tooltip:{template:e=>"ipg:details_area"==e.id&&e.value?appdata.sridTooltip:""},elements:[{type:"label",label:"&nbsp;"+__("Spatialunit Data")},{type:"text",name:"ipg:details_suid",id:"ipg:details_suid",label:__("ID")},{type:"text",name:"ipg:details_label",id:"ipg:details_label",label:__("Label/Name")},{type:"text",name:"ipg:details_area",id:"ipg:details_area",label:__("Area aprox.")+'<sup class="srid">*</sup>',css:"srid_value"},{type:"text",name:"ipg:details_physicalid",id:"ipg:details_physicalid",label:__("Physical ID")},{type:"date",name:"ipg:details_type",id:"ipg:details_type",label:__("Type")}]},{view:"button",value:__("Return"),autowidth:!0,align:"center",css:"button_border",click:ApprovalCtrl.resetInspectionForms}]},{borderless:!0,view:"resizer"},{rows:[{id:"apv:party_grid",view:"datatable",select:"row",multiselect:!0,clipboard:"selection",columns:[{id:"ipg:check",header:{text:__("Status"),css:{"text-align":"center"},height:25},width:80,css:{"text-align":"center"},template:t=>-1===ApprovalCtrl.approvalParties.findIndex(e=>e.id_number==t.id_number)?'<div class="webix_el_button"><button class="webixtype_base checkButton"><i class="mdi mdi-checkbox-blank-outline"></i></button></div>':'<i class="mdi mdi-checkbox-marked-outline"></i>'},{id:"ipg:full_name",map:"full_name",header:__("Full Name"),fillspace:!0},{id:"ipg:party_id",map:"id_number",header:__("ID Number"),width:110,format:e=>"null"==e?__("---"):idNumberFormat(e),css:{"text-align":"right"}},{id:"sign",header:{text:'<i class="mdi mdi-signature-freehand"></i>',css:{"text-align":"center"}},width:80,template:function(t){var e="webixtype_base signButton",i=__("Sign");return-1===ApprovalCtrl.approvalParties.findIndex(e=>e.id_number==t.id_number)&&(e+=" no_id_yet",i=__("check")),'<div class="webix_el_button"><button class="'+e+'">'+i+"</button></div>"}}],onClick:{signButton:function(e,t){var i=this.getItem(t);if(-1===ApprovalCtrl.approvalParties.findIndex(e=>e.id_number==i.id_number))return webix.alert({text:__("Please verify the identity of")+"<br /><i>"+i.full_name+"</i><br />"+__("to enable signing"),type:"alert-error"}),!1;ApprovalCtrl.onShowSignForm(i)},checkButton:function(e,t){if(!this.getItem(t).id_number)return webix.alert({text:__("Cannot proceed without the<br />ID Number of")+"<br /><i>"+this.getItem(t).full_name,type:"alert-error"}),!1;ApprovalCtrl.onIdCheckButtonClick(this.getItem(t))}},on:{"data->onStoreUpdated":function(){this.data.each(function(e,t){e.index=t+1,e.index%2==0&&(e.$css="odd_row")})}}},{cols:[{},{view:"button",value:__("Right Details"),autowidth:!0,align:"center",css:"button_border",click:()=>{RightsWindow.show()}},{}]}]},{width:7},{id:"apv:neighbours_grid",view:"datatable",width:300,select:"row",columns:[{id:"ipg:neigh_suid",map:"neigh_suid",header:{text:__("Parcel"),height:25},width:60,css:{"text-align":"center"}},{id:"ipg:neigh_name",map:"neigh_name",header:__("Neighbour Name"),fillspace:!0,template:e=>e.neigh_name||__("---")}]}]};export{PartyGrid};